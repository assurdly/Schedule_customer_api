// Set access_token as collection variable
const jsonData = pm.response.json();

if (jsonData.data && jsonData.data.access_token) {
    pm.collectionVariables.set("access_token", jsonData.data.access_token);
    console.log("Access token set:", jsonData.data.access_token);
} else {
    console.warn("Access token not found in response.");
}

// Set customer ID if available
if (jsonData.data && jsonData.data.customer && jsonData.data.customer.id) {
    pm.collectionVariables.set("id", jsonData.data.customer.id);
}

//pm.collectionVariables.set("access_token", jsonData.data.access_token);
//pm.collectionVariables.set("id", jsonData.data.customer.id);

// Validate message is "Verification successful"
pm.expect(jsonData.message).to.equal("Login successful");

// Verify customer object is returned
pm.expect(jsonData.data.customer).to.exist;
pm.expect(jsonData.data.customer).to.be.an('object');
